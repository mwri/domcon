{"version":3,"sources":["../lib/domcon.js"],"names":["domcon","a","b","c","d","e","con_strict","name","attrs","inner","name_alt","parent","undefined","length","ele","document","createElement","attr_name","setAttribute","_ele_name","_parent","_nav_id","innerHTML","Array","i","child","child_dc","child_name","child_attrs","child_inner","child_name_alt","nav_id","appendChild","nav_first","push","con_terse","descr","default_child","descr_keys","Object","keys","Error","match","exec","attrs_descr","split","forEach","ad","equals_index","indexOf","substr","map","default_child_info","call","apply","module","exports","default","window"],"mappings":"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","file":"domcon.js","sourcesContent":["class domcon {\n\n    constructor (a, b, c, d, e) {\n\n        function con_strict (name, attrs, inner, name_alt, parent) {\n\n            if (attrs === undefined)\n                attrs = {};\n\n            this[0] = this;\n            this.length = 1;\n\n            let ele = document.createElement(name);\n            for (let attr_name in attrs)\n                ele.setAttribute(attr_name, attrs[attr_name]);\n\n            this.e         = ele;\n            this._ele_name = name;\n            this._parent   = parent;\n            this._nav_id   = name_alt || name;\n\n            if (typeof inner === 'string') {\n                ele.innerHTML = inner;\n            } else if (typeof inner === 'object' && inner instanceof Array) {\n                for (let i = 0; i < inner.length; i++) {\n                    let child = inner[i];\n                    let child_dc;\n                    if (child instanceof Array) {\n                        let child_name = child[0];\n                        let child_attrs = child[1];\n                        let child_inner = child[2];\n                        let child_name_alt = child[3];\n                        child_dc = new domcon(\n                            child_name,\n                            child_attrs,\n                            child_inner,\n                            child_name_alt,\n                            this\n                        );\n                    } else {\n                        child_dc = new domcon(child, this);\n                    }\n                    let nav_id = child_dc._nav_id;\n                    ele.appendChild(child_dc.e);\n                    if (this[nav_id] === undefined) {\n                        this[nav_id] = child_dc;\n                    } else {\n                        if (this[nav_id] instanceof domcon) {\n                            let nav_first = this[nav_id];\n                            this[nav_id] = [];\n                            this[nav_id].push(nav_first);\n                        }\n                        this[nav_id].push(child_dc);\n                    }\n                }\n            }\n\n        }\n\n        function con_terse (descr, parent) {\n\n            function default_child (name, parent) {\n\n                if (name === 'tr') {\n                    if (parent === undefined)\n                        return undefined;\n                    else if (parent._ele_name === 'tbody')\n                        return {\n                            'name': 'td',\n                            'attrs': {},\n                        };\n                    else if (parent._ele_name === 'thead')\n                        return {\n                            'name': 'th',\n                            'attrs': {},\n                        };\n                    else if (parent._ele_name === 'table')\n                        return {\n                            'name': 'th',\n                            'attrs': {},\n                        };\n                    else\n                        return undefined;\n                }\n\n                return undefined;\n\n            }\n\n            let descr_keys = Object.keys(descr);\n            if (descr_keys.length !== 1)\n                throw new Error('calling domcon constructor with an object parameter, only a single key is permitted');\n\n            let match = /^(\\S+?)(|\\/(\\S+?))(|\\[(.*)\\])$/.exec(descr_keys[0]);\n            if (!match)\n                throw new Error('invalid element description \"'+descr+'\"');\n            let name = match[1];\n            let name_alt = match[3];\n            let attrs_descr = match[5];\n            let attrs = {};\n            if (attrs_descr !== undefined && attrs_descr !== '')\n                attrs_descr.split(/,/).forEach((ad) => {\n                    let equals_index = ad.indexOf('=\"');\n                    if (equals_index === -1)\n                        throw new Error('invalid attribute description \"'+ad+'\"');\n                    attrs[ad.substr(0, equals_index)] = ad.substr(equals_index + 2, ad.length - equals_index - 3);\n                });\n\n            let inner;\n            if (typeof descr[descr_keys[0]] === 'string') {\n                inner = descr[descr_keys[0]];\n            } else {\n                inner = descr[descr_keys[0]].map((e) => {\n                    if (e instanceof Array || typeof e === 'object') {\n                        return e;\n                    } else if (typeof e === 'string') {\n                        let default_child_info = default_child(name, parent);\n                        if (default_child_info === undefined)\n                            throw new Error('do not know what element to include for \"'+e+'\"');\n                        return [default_child_info.name, default_child_info.attrs, e];\n                    } else {\n                        throw new Error('expression \"'+e+'\" not understood');\n                    }\n                });\n            }\n\n            return con_strict.call(this, name, attrs, inner, name_alt, parent);\n\n        }\n\n        if (typeof a === 'string') {\n            return con_strict.call(this, a, b, c, d, e);\n        } else if (typeof a === 'object') {\n            if (a instanceof Array)\n                return con_strict.apply(this, a);\n            else\n                return con_terse.call(this, a, b);\n        } else {\n            throw new Error('the first argument must be a string or an object');\n        }\n\n    }\n\n    extend (a, b, c, d, e) {\n\n        if (typeof a !== 'string' && typeof a !== 'object')\n            throw new Error('the first argument must be a string or an object');\n\n        let child_dc = typeof a === 'string'\n            ? new domcon(a, b, c, d, e, this)\n            : a instanceof Array\n                ? new domcon(a[0], a[1], a[2], a[3], a[4], this)\n                : new domcon(a, this);\n\n        let nav_id = child_dc._nav_id;\n        this.e.appendChild(child_dc.e);\n        if (this[nav_id] === undefined) {\n            this[nav_id] = child_dc;\n        } else {\n            if (this[nav_id] instanceof domcon) {\n                let nav_first = this[nav_id];\n                this[nav_id] = [];\n                this[nav_id].push(nav_first);\n            }\n            this[nav_id].push(child_dc);\n        }\n\n        return this;\n\n    }\n\n    append_to (parent) {\n\n        if (parent instanceof domcon) {\n            parent.e.appendChild(this.e);\n            this._parent = parent;\n        } else {\n            parent.appendChild(this.e);\n        }\n\n        return this;\n\n    }\n\n    append (child) {\n\n        if (child instanceof domcon)\n            this.e.appendChild(child.e);\n        else\n            this.e.appendChild(child);\n\n        return this;\n\n    }\n\n}\n\n\nif (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n    module.exports = { default: domcon };\n} else if (typeof window !== 'undefined') {\n    window.domcon = domcon;\n}\n"]}