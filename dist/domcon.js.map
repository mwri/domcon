{"version":3,"sources":["../lib/domcon.js"],"names":["domcon","a","b","c","d","e","con_strict","name","attrs","inner","name_alt","parent","undefined","ele","document","createElement","attr_name","setAttribute","_ele_name","_parent","_nav_id","innerHTML","Array","i","length","child","child_dc","child_name","child_attrs","child_inner","child_name_alt","nav_id","appendChild","nav_first","push","con_terse","descr","default_child","descr_keys","Object","keys","Error","match","exec","attrs_descr","split","forEach","ad","equals_index","indexOf","substr","map","default_child_info","call","parent_element","child_element","exports","default","window"],"mappings":"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","file":"domcon.js","sourcesContent":["class domcon {\n\n    constructor (a, b, c, d, e) {\n\n        function con_strict (name, attrs, inner, name_alt, parent) {\n\n            if (attrs === undefined)\n                attrs = {};\n\n            this[0] = this;\n\n            let ele = document.createElement(name);\n            for (let attr_name in attrs)\n                ele.setAttribute(attr_name, attrs[attr_name]);\n\n            this.e         = ele;\n            this._ele_name = name;\n            this._parent   = parent;\n            this._nav_id   = name_alt || name;\n\n            if (typeof inner === 'string') {\n                ele.innerHTML = inner;\n            } else if (typeof inner === 'object' && inner instanceof Array) {\n                for (let i = 0; i < inner.length; i++) {\n                    let child = inner[i];\n                    let child_dc;\n                    if (child instanceof Array) {\n                        let child_name = child[0];\n                        let child_attrs = child[1];\n                        let child_inner = child[2];\n                        let child_name_alt = child[3];\n                        child_dc = new domcon(\n                            child_name,\n                            child_attrs,\n                            child_inner,\n                            child_name_alt,\n                            this\n                        );\n                    } else {\n                        child_dc = new domcon(child, this);\n                    }\n                    let nav_id = child_dc._nav_id;\n                    ele.appendChild(child_dc.e);\n                    if (this[nav_id] === undefined) {\n                        this[nav_id] = child_dc;\n                    } else {\n                        if (this[nav_id] instanceof domcon) {\n                            let nav_first = this[nav_id];\n                            this[nav_id] = [];\n                            this[nav_id].push(nav_first);\n                        }\n                        this[nav_id].push(child_dc);\n                    }\n                }\n            }\n\n        }\n\n        function con_terse (descr, parent) {\n\n            function default_child (name, parent) {\n\n                if (name === 'tr') {\n                    if (parent === undefined)\n                        return undefined;\n                    else if (parent._ele_name === 'tbody')\n                        return {\n                            'name': 'td',\n                            'attrs': {},\n                        };\n                    else if (parent._ele_name === 'table')\n                        return {\n                            'name': 'th',\n                            'attrs': {},\n                        };\n                    else\n                        return undefined;\n                }\n\n                return undefined;\n\n            }\n\n            let descr_keys = Object.keys(descr);\n            if (descr_keys.length !== 1)\n                throw new Error('calling domcon constructor with an object parameter, only a single key is permitted');\n\n            let match = /^(\\S+?)(|\\/(\\S+?))(|\\[(.*)\\])$/.exec(descr_keys[0]);\n            if (!match)\n                throw new Error('invalid element description \"'+descr+'\"');\n            let name = match[1];\n            let name_alt = match[3];\n            let attrs_descr = match[5];\n            let attrs = {};\n            if (attrs_descr !== undefined && attrs_descr !== '')\n                attrs_descr.split(/,/).forEach((ad) => {\n                    let equals_index = ad.indexOf('=\"');\n                    if (equals_index === -1)\n                        throw new Error('invalid attribute description \"'+ad+'\"');\n                    attrs[ad.substr(0, equals_index)] = ad.substr(equals_index + 2, ad.length - equals_index - 3);\n                });\n\n            let inner;\n            if (typeof descr[descr_keys[0]] === 'string') {\n                inner = descr[descr_keys[0]];\n            } else {\n                inner = descr[descr_keys[0]].map((e) => {\n                    if (e instanceof Array || typeof e === 'object') {\n                        return e;\n                    } else if (typeof e === 'string') {\n                        let default_child_info = default_child(name, parent);\n                        if (default_child_info === undefined)\n                            throw new Error('do not know what element to include for \"'+e+'\"');\n                        return [default_child_info.name, default_child_info.attrs, e];\n                    } else {\n                        throw new Error('expression \"'+e+'\" not understood');\n                    }\n                });\n            }\n\n            return con_strict.call(this, name, attrs, inner, name_alt, parent);\n\n        }\n\n        if (typeof a === 'string') {\n            return con_strict.call(this, a, b, c, d, e);\n        } else if (typeof a === 'object') {\n            return con_terse.call(this, a, b);\n        } else {\n            throw new Error('the first argument must be a string or an object');\n        }\n\n    }\n\n    append_to (parent_element) {\n\n        parent_element.appendChild(this.e);\n\n        return this;\n\n    }\n\n    append (child_element) {\n\n        this.e.appendChild(child_element);\n\n        return this;\n\n    }\n\n}\n\n\nif (typeof exports !== 'undefined') {\n    exports = { default: domcon };\n} else if (typeof window !== 'undefined') {\n    window.domcon = domcon;\n}\n"]}