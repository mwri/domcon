{"version":3,"sources":["../lib/domcon.js"],"names":["domcon","a","b","c","d","e","con_strict","name","attrs","inner","name_alt","parent","undefined","jqs","$","attr_name","attr","_jqs","_ele_name","_parent","_nav_id","text","Array","i","length","child","child_dc","child_name","child_attrs","child_inner","child_name_alt","nav_id","append","jquery","nav_first","push","con_terse","descr","descr_keys","Object","keys","Error","match","exec","attrs_descr","split","forEach","ad","equals_index","indexOf","substr","map","default_child_info","default_child","call","to","ele_name","module","exports","default","window"],"mappings":"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","file":"domcon.js","sourcesContent":["class domcon {\n\n    constructor (a, b, c, d, e) {\n\n        function con_strict (name, attrs, inner, name_alt, parent) {\n\n            if (attrs === undefined)\n                attrs = {};\n\n            this[0] = this;\n\n            let jqs = $('<'+name+'></'+name+'>');\n            for (let attr_name in attrs)\n                jqs.attr(attr_name, attrs[attr_name]);\n\n            this._jqs      = jqs;\n            this._ele_name = name;\n            this._parent   = parent;\n            this._nav_id   = name_alt || name;\n\n            if (typeof inner === 'string') {\n                jqs.text(inner);\n            } else if (typeof inner === 'object' && inner instanceof Array) {\n                for (let i = 0; i < inner.length; i++) {\n                    let child = inner[i];\n                    let child_dc;\n                    if (child instanceof Array) {\n                        let child_name = child[0];\n                        let child_attrs = child[1];\n                        let child_inner = child[2];\n                        let child_name_alt = child[3];\n                        child_dc = new domcon(\n                            child_name,\n                            child_attrs,\n                            child_inner,\n                            child_name_alt,\n                            this\n                        );\n                    } else {\n                        child_dc = new domcon(child, this);\n                    }\n                    let nav_id = child_dc.nav_id();\n                    jqs.append(child_dc.jquery());\n                    if (this[nav_id] === undefined) {\n                        this[nav_id] = child_dc;\n                    } else {\n                        if (this[nav_id] instanceof domcon) {\n                            let nav_first = this[nav_id];\n                            this[nav_id] = [];\n                            this[nav_id].push(nav_first);\n                        }\n                        this[nav_id].push(child_dc);\n                    }\n                }\n            }\n\n        }\n\n        function con_terse (descr, parent) {\n\n            let descr_keys = Object.keys(descr);\n            if (descr_keys.length !== 1)\n                throw new Error('calling domcon constructor with an object parameter, only a single key is permitted');\n\n            let match = /^(\\S+?)(|\\/(\\S+?))(|\\[(.*)\\])$/.exec(descr_keys[0]);\n            if (!match)\n                throw new Error('invalid element description \"'+descr+'\"');\n            let name = match[1];\n            let name_alt = match[3];\n            let attrs_descr = match[5];\n            let attrs = {};\n            if (attrs_descr !== undefined && attrs_descr !== '')\n                attrs_descr.split(/,/).forEach((ad) => {\n                    let equals_index = ad.indexOf('=\"');\n                    if (equals_index === -1)\n                        throw new Error('invalid attribute description \"'+ad+'\"');\n                    attrs[ad.substr(0, equals_index)] = ad.substr(equals_index + 2, ad.length - equals_index - 3);\n                });\n\n            let inner;\n            if (typeof descr[descr_keys[0]] === 'string') {\n                inner = descr[descr_keys[0]];\n            } else {\n                inner = descr[descr_keys[0]].map((e) => {\n                    if (e instanceof Array || typeof e === 'object') {\n                        return e;\n                    } else if (typeof e === 'string') {\n                        let default_child_info = domcon.default_child(name, parent);\n                        if (default_child_info === undefined)\n                            throw new Error('do not know what element to include for \"'+e+'\"');\n                        return [default_child_info.name, default_child_info.attrs, e];\n                    } else {\n                        throw new Error('expression \"'+e+'\" not understood');\n                    }\n                });\n            }\n\n            return con_strict.call(this, name, attrs, inner, name_alt, parent);\n\n        }\n\n        if (typeof a === 'string') {\n            return con_strict.call(this, a, b, c, d, e);\n        } else if (typeof a === 'object') {\n            return con_terse.call(this, a, b);\n        }\n\n    }\n\n    append_to (to) {\n\n        $(to).append(this._jqs);\n\n        return this;\n\n    }\n\n    jquery () {\n\n        return this._jqs;\n\n    }\n\n    nav_id () {\n\n        return this._nav_id;\n\n    }\n\n    ele_name () {\n\n        return this._ele_name;\n\n    }\n\n    static default_child (name, parent) {\n\n        if (name === 'tr') {\n            if (parent === undefined)\n                return undefined;\n            if (parent.ele_name() === 'tbody')\n                return {\n                    'name': 'td',\n                    'attrs': {},\n                };\n            if (parent.ele_name() === 'table')\n                return {\n                    'name': 'th',\n                    'attrs': {},\n                };\n        }\n\n        return undefined;\n\n    }\n\n}\n\n\nif (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n    module.exports = { default: domcon };\n} else {\n    window.domcon = domcon;\n}\n"]}